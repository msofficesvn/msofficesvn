#Autolock function

= Introduction =

SVN管理下にある、svn:needs-lock属性付のファイルを編集したときに、ロックするかどうかユーザーへ聞き、必要であればロック取得コマンドを実行できる機能。


= Details =

== Excel ==

ワークシートの編集をチェックするタイミングには、以下の2方式が考えられる。

 * セルの編集確定時に呼び出される、SheetChangeイベントハンドラでチェックする。
 * タイマーを作成してチェックする。

== Word ==

ドキュメントの編集をチェックするタイミングに関しては、
Wordにはドキュメント変更イベントハンドラは無さそうなので、タイマー方式一択。

== PowerPoint ==

プレゼンテーションの編集をチェックするタイミングに関しては、
ドキュメント変更イベントハンドラは無さそうで、OnTime関数すらない。

タイマーはWindows APIを使う必要があるらしい。

http://social.msdn.microsoft.com/Forums/en-US/isvvba/thread/9f6891f2-d0c4-47a6-b63f-48405aae4022/

http://www.h3.dion.ne.jp/~sakatsu/Excel_Tips15.htm

== 実装試行結果 ==

2012/12/09

Excel, WordでOnTime()を利用したタイマー方式で実装してみた。
ワークシートやドキュメントを多く開いているとPCへの負荷が大きくなる感じ。特にExcelはCPU timeを消費しやすいように感じる。wordはそれほどでもない。
マウスカーソルには、ポインタの横に常に砂時計が表示される状態となる。

[結論]

ワークシートの編集をチェックするタイミングに関しては、
タイマー方式はできるだけ避け、必要最小限の利用となるようにするべき。
すなわち、以下のようにするべき。

 * ExcelではSheetChangeイベントハンドラを利用
 * Word, PowerPointではタイマー方式

また、タイマー方式は何かとトラブルの原因となりやすいので、ユーザーがアドインの編集チェック動作をオフにできるUIも設けるべきだろう。